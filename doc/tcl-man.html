<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.72 [en] (X11; U; Linux 2.2.14-5.0 i686) [Netscape]">
   <meta name="Author" content="Kåre Sjölander">
   <meta name="Description" content="Manual page for Snack">
   <title>Snack Manual</title>
</head>
<body text="#000000" bgcolor="#FFFFFF" link="#0000EE" vlink="#551A8B" alink="#FE0000">

<h1>

<hr></h1>

<h1>
<b>Snack v2.0.7 manual</b></h1>
<font color="#FF6600">Last updated&nbsp;</font><script LANGUAGE="JavaScript">document.write(document.lastModified)</script>

<dl>
<dt>
<a href="#audio">snack::audio</a></dt>

<dt>
<a href="#filter">snack::filter</a></dt>

<dt>
<a href="#mixer">snack::mixer</a></dt>

<dt>
<a href="#sound">snack::sound</a></dt>

<dt>
<a href="#spectrogram">spectrogram canvas item</a></dt>

<dt>
<a href="#section">spectrum section canvas item</a></dt>

<dt>
<a href="#waveform">waveform canvas item</a></dt>

<dt>
&nbsp;</dt>

<dt>
<a href="SnackLib.html">Snack library</a></dt>
</dl>

<hr>
<h3>
<a NAME="audio"></a>NAME</h3>
snack::audio - Get/set properties of audio devices
<h3>
SYNOPSIS</h3>
<b>snack::audio property</b> ?arg? ...
<h3>
DESCRIPTION</h3>
The audio command is used to get properties of audio devices such as supported
sample encoding formats and sample rates.
<p><b>snack::audio encodings</b>
<ul>Returns a list of supported sample encoding formats for the current
selected device.</ul>
<b>snack::audio rates</b>
<ul>Returns a list of supported sample rates for the current selected device.</ul>
<b>snack::audio inputDevices</b>
<blockquote>Returns a list of available audio input devices.</blockquote>
<a NAME="latency"></a><b>snack::audio playLatency</b>
<blockquote>Sets/queries (in ms) how much sound will be queued up at any
time to the audio device for playback. A low value makes new sound samples
reach the loudspeakers quickly at the risk of gaps in the output stream.
An appropriate value should be chosen with regard to processor speed and
load. The default value has been choosen to give adequate performance for
a mix of tasks and might be to low for simple playback in some cases. If
spurious gaps in the playback stream occur, try using a latency of a couple
of thousand milliseconds. On UNIX systems, the environment variable PLAYLATENCY
can also be used to control this property.</blockquote>
<b>snack::audio pause</b>
<ul>Toggles between pause/play for all playback on the audio device.</ul>
<b>snack::audio play</b>
<ul>Resumes paused playback on the audio device.</ul>
<b>snack::audio play_gain</b><i> ?value?</i>
<ul>Returns the current play gain value if invoked without a parameter.
If a an integer value is given play gain is set to the given value. Valid
values are in the range 0-100.</ul>
<b>snack::audio outputDevices</b>
<blockquote>Returns a list of available audio output devices.</blockquote>
<b>snack::audio record_gain</b><i> ?value?</i>
<ul>Returns the current record gain value if invoked without a parameter.
If a an integer value is given record gain is set to the given value. Valid
values are in the range 0-100.</ul>
<b>snack::audio selectOutput</b><i> ?device?</i>
<blockquote>Selects an audio output device to be used as default.</blockquote>
<b>snack::audio scaling</b><i> ?factor?</i>
<blockquote>Scale the global output stream by multiplying with <i>factor</i>.
Useful to prevent clipping when playing many simultaneous sounds. If no
value is specified the current factor is returned, default is 1.0.</blockquote>
<b>snack::audio selectInput</b><i> ?device?</i>
<blockquote>Selects an audio input device to be used as default.</blockquote>
<b>snack::audio stop</b>
<ul>Stops all playback on the audio device.</ul>

<hr>
<h3>
<a NAME="filter"></a>NAME</h3>
snack::filter - Create and manipulate filters
<h3>
SYNOPSIS</h3>
<b>snack::filter type</b> ?arg? ...
<p><i>filterName option ?arg arg ...?</i>
<h3>
DESCRIPTION</h3>
The filter command is used to create filter objects. These can interact
with sound objects either using the sound <a href="#sfilter">filter</a>
command or during <a href="#splay">playback</a>. Note that since a filter
object may contain state information about a sound stream it should only
be used for one play operation at a time.
<h3>
FILTER COMMAND</h3>
When a filter object is created, Snack returns the name of a newly created
object command. This command may be used to invoke various operations on
the filter.
<p><i>filterCmd</i> <b>configure ?arg ...?</b>
<blockquote>Configures the filter command, see the filter types for their
respective options.</blockquote>
<i>filterCmd</i> <b>destroy</b>
<blockquote>Removes the filter command and frees the storage associated
with it. If the filter is currently used for playback an unfiltered stream
will be output as soon as the internal buffer has been played.</blockquote>

<h3>
FILTERS TYPES</h3>
Current filter types.
<p><b>compose</b><i> filter filter ...</i>
<blockquote>Creates a new filter which is a linear combination of two or
more other filters. The output of the first is fed into the input of the
next and so on.</blockquote>
<b>echo</b><i> inGain outGain delay decay ?delay decay ...?</i>
<blockquote>Creates an echo effect. <i>inGain</i> is a multiplicative factor
applied on the input stream. <i>outGain</i> is applied on the output. Both
factors should be between 0.0 and 1.0.&nbsp; For each echo a delay/decay
pair should be specified. The <i>delay</i> is specified in milliseconds
and <i>decay</i> is a factor relative to <i>inGain</i>.</blockquote>
<b>formant</b> <i>frequency</i> <i>bandwidth</i>
<blockquote>A formant filter with given <i>frequency</i> and <i>bandwidth</i>.</blockquote>
<b>generator</b> <i>frequency</i> <i>?amplitude? ?shape? ?type? ?ntot?</i>
<blockquote>A signal generator with given <i>frequency</i> and <i>amplitude</i>.
<i>shape</i>
is a value between 0.0 and 1.0 used to influence the shape of the signal.
<i>type</i>
can be any of rectangle, triangle, sine, noise, or sampled. In the case
of sampled the generator will repeatedly get data from the sound it is
applied on. <i>ntot</i> specifies how many samples to generate. The default,
-1, will generate forever.</blockquote>
<b>map</b><i> val ?val val val ...?</i>
<blockquote>Applies a linear transformation on each sample frame. For one
channel sounds this is simply a multiplication. For multi-channel sounds,
a transformation matrix can be specified with values row by row. One column
per channel is needed. If mono output is used, only one row needs to be
specified. If stereo output is used, only two rows needs to be specified.
If only one value is specified and the filter is used for multi-channel
data, each channel is multiplied with the given value.</blockquote>
<b>reverb</b> <i>outGain time delay ?delay ...?</i>
<blockquote>A reverb effect. <i>outGain</i> is a value between 0.0 and
1.0. <i>time</i> and <i>delay</i> are given in milliseconds.</blockquote>

<h3>
BUGS</h3>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This command is under development.
<h3>

<hr WIDTH="100%"></h3>

<h3>
<a NAME="mixer"></a><b>NAME</b></h3>
snack::mixer - Get/set properties of mixer devices
<br>&nbsp;
<h3>
<b>SYNOPSIS</b></h3>
<b>snack::mixer property</b> ?arg? ...
<h3>
DESCRIPTION</h3>
The mixer command is used to get and set properties of mixer devices such
as current input/output jack, supported ports, mixer lines, and gain.
<p><b>snack::mixer channels </b><i>line</i>
<ul>Returns a list with the names of the channels for the specified <i>line</i>.</ul>
<b>snack::mixer devices</b>
<blockquote>Returns a list of available mixer devices.</blockquote>
<b>snack::mixer input </b><i>?jack? ?varName?</i>
<ul>Gets/sets the current input jack. Optionally link a boolean Tcl variable.</ul>
<a NAME="inputs"></a><b>snack::mixer inputs</b>
<ul>Returns a list of available input ports.</ul>
<b>snack::mixer lines</b>
<ul>Returns a list with the names of the lines of the mixer device.</ul>
<b>snack::mixer output </b><i>?jack? ?varName?</i>
<ul>Gets/sets the current output jack. Optionally link a boolean Tcl variable.</ul>
<a NAME="outputs"></a><b>snack::mixer outputs</b>
<ul>Returns a list of available output ports.</ul>
<b>snack::mixer update</b>
<ul>Updates all linked variables to reflect the status of the mixer device.</ul>
<b>snack::mixer volume</b><i> line ?varName? ?varName?</i>
<ul>Return the current volume setting for <i>mixer</i>. Optionally link
a Tcl variable to the value. If two variable names are specified they are
used for the left and right channels respectively.</ul>
<b>snack::mixer select</b><i> ?device?</i>
<blockquote>Selects a mixer device to be used as default.</blockquote>

<hr WIDTH="100%">
<br>NAME
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; snack::sound - Create and
manipulate sounds
<br><a href="#SYNOPSIS">SYNOPSIS</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; snack::sound ?name? ?options?
<br><a href="#DESCRIPTION">DESCRIPTION</a>
<br><a href="#CREATING SOUNDS">CREATING SOUNDS</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#sfile">snack::sound
?name? ?-load filename?&nbsp;<i> </i>?-file filename?&nbsp; ?-channel channelname?
?-rate f? ?-channels n? ?-encoding fmt? ?-fileformat fmt? ?-skiphead n?
?-byteorder endianess? ?-guessproperties boolean?&nbsp; ?-buffersize n?
?-precision prec? -changecommand procedure?</a>
<br><a href="#SOUND COMMAND">SOUND COMMAND</a>
<dd>
<a href="#sapp"><i>soundName </i><b>append variable</b> <b>?-rate f? ?-channels
n? ?-encoding fmt? ?-skiphead n? ?-byteorder endianess? ?-start start?
?-end end? ?-guessproperties boolean?</b></a></dd>

<dd>
<a href="#scget"><i>soundName </i><b>cget option</b></a></dd>

<dd>
<a href="#schanged"><i>soundName </i><b>changed flag</b></a></dd>

<dd>
<a href="#sconc"><i>soundName </i><b>concatenate sound</b></a></dd>

<dd>
<a href="#sconf"><i>soundName </i><b>configure option value ...</b></a></dd>

<dd>
<a href="#sconv"><i>soundName </i><b>convert option value</b></a></dd>

<dd>
<a href="#scopy"><i>soundName </i><b>copy sound</b> <b>?-start start? ?-end
end?</b></a></dd>

<dd>
<a href="#scut"><i>soundName </i><b>cut sound start end</b></a></dd>

<dd>
<a href="#scrop"><i>soundName </i><b>crop start end</b></a></dd>

<dd>
<a href="#sdata"><i>soundName </i><b>data variable ?-rate f? ?-channels
n? ?-encoding fmt? ?-skiphead n? ?-byteorder endianess?</b> <b>?-start
start? ?-end end? ?-guessproperties boolean?</b></a></dd>

<dd>
<a href="#sdata"><i>soundName </i><b>data ?-start start? ?-end end? ?-fileformat
fileformat? ?-byteorder endianess?</b></a></dd>

<dd>
<a href="#sdest"><i>soundName </i><b>destroy</b></a></dd>

<dd>
<a href="#sfft"><i>soundName </i><b>dBPowerSpectrum ?-start sample? ?-end
sample? ?-skip samples? ?-fftlength length? ?-windowlength length? ?-channel
channel? ?-preemphasis factor?</b></a></dd>

<dd>
<a href="#sfilter"><i>soundName </i><b>filter filterName ?-start sample?
?-end sample? ?-continedrain boolean? ?-progress procedure?</b></a></dd>

<dd>
<a href="#sflush"><i>soundName </i><b>flush</b></a></dd>

<dd>
<a href="#sinfo"><i>soundName </i><b>info</b></a></dd>

<dd>
<a href="#sins"><i>soundName </i><b>insert sound position ?-start start?
?-end end?</b></a></dd>

<dd>
<a href="#slen"><i>soundName </i><b>length ?n? ?-unit u?</b></a></dd>

<dd>
<a href="#smax"><i>soundName </i><b>max ?-start start? ?-end</b> <b>end?
?-channel channel?</b></a></dd>

<dd>
<a href="#smin"><i>soundName </i><b>min ?-start start? ?-end</b> <b>end?
?-channel channel?</b></a></dd>

<dd>
<a href="#spause"><i>soundName </i><b>pause</b></a></dd>

<dd>
<a href="#spitch"><i>soundName </i><b>pitch ?-start start? ?-end</b> <b>end?
?-maxpitch val? ?-minpitch val? ?-progress callback?</b></a></dd>

<dd>
<a href="#splay"><i>soundName </i><b>play ?-start start? ?-end end? ?-output
jack? ?-blocking boolean? -command ?callback? ?-device outputDevice? ?-rate
rate? ?-channels channels?</b></a></dd>

<dd>
<a href="#sread"><i>soundName </i><b>read </b><i>filename</i><b> ?-rate
f? ?-channels n? ?-encoding fmt? ?-skiphead n? ?-byteorder endianess??-start
start? ?-end end? ?-guessproperties boolea</b></a><b><a href="#srec">n?
?-progress procedure?</a></b></dd>

<dd>
<a href="#srec"><i>soundName </i><b>record ?-input jack? ?-append boolean?
?-device inputDevice?</b></a></dd>

<dd>
<a href="#srev"><i>soundName </i><b>reverse ?-start start? ?-end end? ?-progress
procedure?</b></a></dd>

<dd>
<a href="#ssamp"><i>soundName </i><b>sample n ?value? ...</b></a></dd>

<dd>
<a href="#sstop"><i>soundName </i><b>stop</b></a></dd>

<dd>
<a href="#swrite"><i>soundName </i><b>write </b><i>filename</i><b> ?-start
start? ?-end end?</b> <b>?-fileformat fileformat? ?-progress procedure?
-byteorder ?endianess?</b></a></dd>

<br>
<hr>
<h3>
<a NAME="sound"></a>NAME</h3>
snack::sound - Create and manipulate sounds
<h3>
<a NAME="SYNOPSIS"></a>SYNOPSIS</h3>
<b>snack::sound </b><i>soundName</i>
<p><i>soundName option ?arg arg ...?</i>
<h3>
<a NAME="DESCRIPTION"></a><b>DESCRIPTION</b></h3>
The <b>snack::sound</b> command is used to create sound objects. Sound
objects can interact with files, variables, canvas items and the audio
hardware.
<h3>
<a NAME="CREATING SOUNDS"></a>CREATING SOUNDS</h3>
The sound command is used to create sound objects. It can take several
different forms, depending on the option argument. The legal forms are:
<p><a NAME="sfile"></a><b>snack::sound </b><i>?soundName? ?-load filename?</i>&nbsp;<i>
?-file filename?</i>&nbsp;<i> ?-channel channelname? ?-rate f? ?-channels
n? ?-encoding fmt? ?-fileformat fmt? ?-skiphead n? ?-byteorder endianess?
?-guessproperties boolean?&nbsp; ?-buffersize n? ?-precision prec? ?-changecommand
procedure?</i>
<p><i>soundName</i> specifies the name of the sound. If it is omitted then
Snack picks a name of the form sound<i>n</i>, where <i>n</i> is an integer.
The <b>-load</b> option specifies that the file <i>filename</i> should
be read into memory after creating the sound. The <b>-file</b> option specifies
an on-disk file which should be linked to the sound. The <b>-channel</b>
option specifies that audio data resides on a channel which should be linked
to the sound. In these cases the audio data is not loaded into memory,
which is useful when playing large files or when using streaming audio.
A value of 1 or larger must be specified for the <b>-channels</b> option
(<b>Mono</b>, or <b>Stereo</b> are also valid). If not specified a default value of 1 is assumed.
Possible values for sample encoding format
are <b>Lin16</b>, <b>Lin8offset</b>, <b>Lin8</b>,<b> Lin24</b>,
<b>Lin32</b>, <b>Float</b>, <b>Alaw</b>, or <b>Mulaw</b>, and if not given the default encoding is <b>Lin16</b>. The option <b>-rate</b> can take any positive value but usually only sample rates supported by the audio hardware are useful. Note that the default value is 16000, a common value for speech related applications, but less frequent for other uses, such as music.
<b>-fileformat</b> works as for the <b>read</b> command.
<b>-skiphead</b> is used to skip an unknown file header of size <b>n</b> bytes.
Byte order can be specified as littleEndian or bigEndian using the
<b>-byteorder</b> option. The option
<b>-guessproperties</b>
is used to specify that Snack should try to infer properties, such as byte
order, sample encoding format, and sample rate for a raw file by analyzing
the contents of the file. Byte order is almost always detected correctly.
For channel based sounds the
<b>-buffersize</b> option can be used to specify
the size of the internal buffer in samples. The option <b>-precision</b>
is used to specify if sound data is to be handled using simple or double
precision internally. -<b>changecommand</b> is used to specify a procedure
which is to be called every time a property of the sound is changed. This
is the Tcl level counterpart of Snack_AddCallback(). The procedure should
expect one argument, one of the strings <i>New, More, </i>or<i> Destroy</i>.
This feature is particularly useful when embedding sound objects in other
higher level constructs.
<p><a NAME="SOUND COMMAND"></a>SOUND COMMAND
<br>When a sound object is created, Snack also creates a new object command
whose name is the same as the sound. This command is used to invoke various
operations (or sub-commands) on the sound. This is the current set:
<p><a NAME="sapp"></a><i>soundName</i> <b>append</b> <i>variable</i> <b>?-rate
f? ?-channels n? ?-encoding fmt? ?-skiphead n? ?-byteorder endianess? ?-start
start? ?-end</b> <b>end? ?-fileformat fmt?</b> <b>?-guessproperties boolean?</b>
<ul>Appends binary string data to the end of <i>soundName</i>. The same
options apply as for the <b>read</b> command. This command applies to in-memory
sounds only.</ul>
<a NAME="scget"></a><i>soundName </i><b>cget option</b>
<ul>The cget command retrieves the current value of an option for a sound.
Option can be any of the following: <b>-load, -file, -channel, -rate, -channels,
-encoding, -skiphead, -byteorder, -guessproperties</b>, <b>-precision</b>,
and <b>-buffersize</b>. See the <a href="#sfile">sound</a> command for
more information on these.</ul>
<a NAME="schanged"></a><i>soundName </i><b>changed flag</b>
<ul>This command is used to inform Snack that the sound object has been
modified. Normally Snack tracks changes to sound objects automatically,
but in a few cases this must be performed explicitly. For example, setting
of samples using the sample command is not tracked for preformance reasons.
Here a <b>changed</b> command might be necessary. <b>flag</b> can be either
<i>New</i>
or <i>More</i>. <i>New</i> is used for any type of change while
<i>More</i>
only applies to the case where more samples has been appended.</ul>
<a NAME="sconc"></a><i>soundName </i><b>concatenate sound</b>
<ul>Concatenates the sample data from <b>sound</b> to the end of <i>soundName</i>.
The sound to be added must be of the same type as the base sound, i.e. have the same sample rate, sample
encoding format, and number of channels). Note that even an initially empty sound has these properties defined. This command applies to in-memory
sounds only.</ul>
<a NAME="sconf"></a><i>soundName </i><b>configure option value ...</b>
<ul>The configure command is used to set options for a sound. Options can
be any of the following: <b>-load, -file, -channel, -rate, -channels, -encoding,
-skiphead, -byteorder, -guessproperties</b>, <b>-precision,</b> and <b>-buffersize</b>.
See the <a href="#sfile">sound</a> command for more information on these.</ul>
<a NAME="sconv"></a><i>soundName </i><b>convert option value ...</b>
<ul>The convert command is used to convert a sound to a different sample
encoding, sample rate, or number of channels. Options can be any of the
following: <b>-rate, -channels,</b> <b>-encoding, </b>and <b>-progress</b>.
A value of 1 or larger must be specified for the <b>-channels</b> option
(<b>Mono</b>, or <b>Stereo</b> are also valid). Only conversions from many
channels to one or the reverse are possible. Values for sample encoding
format are <b>Lin16</b>, <b>Lin8offset</b>, <b>Lin8</b>,<b> Lin24</b>,
<b>Lin32</b>,
<b>Float</b>,
<b>Alaw</b>,
or
<b>Mulaw</b>. The current sample rate conversion algorithm is simple
and may not be suitable for all needs. See the <a href="#sread">read</a>
command for a description on how to use the <b>-progress</b> option. This
command applies to in-memory sounds only.</ul>
<a NAME="scopy"></a><i>soundName </i><b>copy sound</b> <b>?-start start?
?-end end?</b>
<ul>Copies sample data from <b>sound</b>. Optionally a range of samples
to copy can be specified. Any active play operation is stopped before the
command is executed if the format of the new sound differs from the current.
This command applies to in-memory sounds only.</ul>
<a NAME="scrop"></a><i>soundName </i><b>crop start end</b>
<ul>Crops the sound to the given range <b>[start end]</b>, i.e. all samples
before and after these limits will be removed. This command applies to
in-memory sounds only.</ul>
<a NAME="scut"></a><i>soundName </i><b>cut start end</b>
<ul>Cuts the given range <b>[start end]</b> from the sound, i.e. all samples
between and including these limits will be removed. This command applies
to in-memory sounds only.</ul>
<a NAME="sdata"></a><i>soundName </i><b>data ?variable? ?option value?
...</b>
<ul>Loads sound data from, or writes to, a binary string.
<p>When loading data the same options apply as for the <b>read</b> command:
<p><i>soundName </i><b>data variable ?-rate f? ?-channels n? ?-encoding
fmt? ?-skiphead n? ?-byteorder endianess?</b> <b>?-start start? ?-end end??-fileformat
fmt?</b> <b>?-guessproperties boolean?</b>
<p>The command returns the file format detected. Any active play operation
is stopped before data is loaded.
<p>When writing data to a binary string <b>-start</b> and <b>-end</b> options
can be given (as for the <b>write</b> command). Also, a <b>-fileformat</b>
option can be given if the file format should be different from the original.
In the case of RAW file format the endianess can be specified as either
bigEndian or littleEndian.
<p><i>soundName </i><b>data ?-start start? ?-end end?</b> <b>?-fileformat
fileformat? -byteorder ?endianess?</b>
<p>This command applies to in-memory sounds only.</ul>
<a NAME="sdest"></a><i>soundName </i><b>destroy</b>
<ul>Removes the sound command and frees the storage associated with it.</ul>
<a NAME="sfft"></a><i>soundName </i><b>dBPowerSpectrum</b> <b>?-start sample?
?-end sample? ?-fftlength length? ?-windowlength length? ?</b>-<b>windowtype
type?</b><i> </i><b>?-skip samples? ?-channel channel? ?-preemphasisfactor
factor?</b>
<ul>Computes the log FFT power spectrum of the sound at <b>-start</b> and
returns a list of dB values. See the
<a href="#section">section item</a>
for the rest of the options. Optionally an ending point can be given, using
<b>-end</b>.
In this case the result is the average of consecutive FFT's in the specified
range. Their default spacing is taken from <b>-fftlength</b> but this can
be changed using the <b>-skip</b> option which specifies how many points
to move the FFT window forward at each step.</ul>
<a NAME="sfilter"></a><i>soundName </i><b>filter filterName ?-start sample?
?-end sample? ?-continuedrain boolean? ?-progress procedure?</b>
<ul>Applies the <a href="#filter">filter</a> <b>filterName</b> to the sound.
Optionally, a range to apply the filter on can be specified. The <b>-continuedrain
</b>option
specifies whether the filter should be allowed to drain out past the end
point. See the <a href="#sread">read</a> command for a description on how
to use the <b>-progress</b> option. This command applies to in-memory sounds
only.</ul>
<a NAME="sflush"></a><i>soundName </i><b>flush</b>
<ul>Removes all audio data from the sound. This command applies to in-memory
sounds only.</ul>
<a NAME="sinfo"></a><i>soundName </i><b>info</b>
<ul>Returns a list with information about the sound. The entries are {<i>length
rate "maximum sample" "minimum sample" "sample encoding" "number of channels"
"file format" "header size in bytes"</i>}</ul>
<a NAME="sins"></a><i>soundName </i><b>insert sound position ?-start start?
?-end end?</b>
<ul>Inserts sound at position. Optionally a range of samples to insert
can be specified. This command applies to in-memory sounds only.</ul>
<a NAME="slen"></a><i>soundName </i><b>length ?n? ?-unit u?</b>
<ul>Gets or sets the length of the sound in number of samples (default),
or seconds, by setting <b>u</b> to either SAMPLES or SECONDS. If the new
length is larger than the current the sound is padded with additional silence.</ul>
<a NAME="smax"></a><i>soundName </i><b>max ?-start start? ?-end</b> <b>end?
?-channel channel?</b>
<ul>Returns the largest positive sample value of the sound. A range of
samples and a channel to be examined can be specified. The default is to
check all channels and return the maximum value.</ul>
<a NAME="smin"></a><i>soundName </i><b>min ?-start start? ?-end</b> <b>end?
?-channel channel?</b>
<ul>Returns the largest negative sample value of the sound. A range of
samples and a channel to be examined can be specified. The default is to
check all channels and return the minimum value.</ul>
<a NAME="spause"></a><i>soundName </i><b>pause</b>
<ul>Pause current play/record operation. Next <b>pause</b> invocation resumes
play/record. If several play operations for one sound object are in progress
all of them are paused using <b>pause</b>.</ul>
<a NAME="spitch"></a><i>soundName </i><b>pitch ?-start start? ?-endend?
?-maxpitch val? ?-minpitch val? ?-progress procedure?</b>
<ul>Returns a list of pitch values computed using the AMDF method. The
values are spaced at 10ms intervals. A range of samples can be given using
<b>-start</b>
and <b>-end</b>. If a frequency range of valid pitch values is known this
can be specified using the options <b>-maxpitch</b> and <b>-minpitch</b>.
See the <a href="#sread">read</a> command for a description on how to use
the <b>-progress</b> option.</ul>
<a NAME="splay"></a><i>soundName </i><b>play ?-start start? ?-end end?
?-output jack??-blocking boolean? ?-command callback? ?-device outputDevice?
?-filter filter? ?-rate f? ?-channels n?</b>
<ul>Plays a sound. A range of samples to play can be specified using the
<b>-start</b>
and <b>-end</b> options. The <b>-output</b> option is used to specify any
of the possible output ports returned by the <a href="#outputs">audio outputs</a>
command. The <b>-blocking</b> option is used to specify whether playback
should be asynchronous or not, i.e. if it is to be played in the background
or if the <b>play</b> command should return only after the sound has been
played. Asynchronous playback from tclsh is only possible if the event
loop is running, using for example <b>vwait</b>. The <b>-command</b> option
specifies a command to be executed when the end of the sound is reached.
The <b>-device</b> option selects which audio output device to use. The
<b>-filter</b>
option is used to specify a <a href="#filter">filter</a> which is to be
applied during output. The audio device can be opened with different properties
from those of the sound object using <b>-rate</b> and <b>-channels</b>,
which might be useful in some rare cases. The option
<b>-starttime</b>
is used to schedule the start of playback (in ms) relative to a previous
play operation. All options are ignored if <b>play</b> is used to resume
a paused play operation. If a <b>play </b>command is issued while another
one is in progress, the latter one is queued up and starts to play as soon
as possible. The lag before this new sound is audible can be controlled
using the <a href="#latency">snack::audio latency</a> command.</ul>
<a NAME="sread"></a><i>soundName </i><b>read </b><i>filename</i><b> ?-fileformat
fmt?</b> <b>?-rate f? ?-channels n? ?-encoding fmt? ?-skiphead n? ?-byteorder
endianess? ?-start start? ?-end end?</b> <b>?-guessproperties boolean?
?-progress procedure?</b>
<ul>Reads new sound data from a file. Current supported file formats are
WAV, MP3, AU, SND, AIFF, SD, SMP, CSL, and RAW binary. The command returns
the file format detected. It is possible to force a file to be read as
RAW using "<b>-fileformat
</b>RAW". In this case the properties of the
sound data should be specified by hand. <b>-rate</b> and <b>-channels</b>
are used to set the sampling rate and the number of channels (<b>Mono</b>/<b>Stereo</b>).
The <b>-encoding</b> option is used to specify sample encoding format.
Currently, the formats <b>Lin16</b>, <b>Lin8offset</b>, <b>Lin8</b>,<b>
Lin24</b>,
<b>Lin32</b>,
<b>Float</b>,
<b>Alaw</b>, and
<b>Mulaw</b> are
supported.
<b>-skiphead</b> is used to skip an unknown header of size <b>n</b>
bytes, and <b>-byteorder</b> is used to specify endianess (<b>bigEndian</b>/<b>littleEndian</b>).&nbsp;
The option
<b>-guessproperties</b> is used to specify that Snack should
try to infer properties, such as byte order, sample encoding format, and
sample rate for raw files by analyzing the contents of the file. Byte order
is almost always detected correctly. It is possible to add a progress callback
procedure which is to be called at regular intervals using the
<b>-progress</b>
option. This procedure is called with two arguments, first the string "Read
sound" and then a double value specifying the fraction of the command that
currently has been completed.&nbsp; If the callback returns with an error
code (return -code error) the read operation is cancelled. The convenience
routine snack::progressCallback opens up a message box with an appropriate
message if used as argument procedure to this option. Any active play operation
is stopped before the command is executed, if the format of the new sound
data differs from the current. This command applies to in-memory sounds
only.</ul>
<a NAME="srec"></a><i>soundName </i><b>record ?option value? ...</b>
<ul>Starts recording data from the audio device into the sound object.
For in-memory sound objects the command has the following form:
<p><i>soundName </i><b>record ?-input jack? ?-append boolean? ?-device
inputDevice?</b>
<ul>&nbsp;</ul>
The <b>-input</b> option specifies one of the available input ports returned
by the <a href="#inputs">audio inputs</a> command. <b>-append</b> specifies
that new audio data should be appended at the end of the existing sound
instead of replacing it. The <b>-device</b> option selects which audio
input device to use.
<p>File and channel based sounds have the options:
<p><i>soundName </i><b>record ?-input jack? ?-fileformat fmt? ?-device
inputDevice?</b>
<p>The <b>-fileformat</b> option can be used to specify the file format
to be used when writing data to a channel. In this case there is no file
name to infer the format from.
<br>&nbsp;</ul>
<a NAME="srev"></a><i>soundName </i><b>reverse ?-start start? ?-end end?
?-progress procedure?</b>
<ul>Reverses a <b>sound</b>. Optionally a range of samples to be reversed
can be specified. See the <a href="#sread">read</a> command for a description
on how to use the <b>-progress</b> option. This command applies to in-memory
sounds only.</ul>
<a NAME="ssamp"></a><i>soundName </i><b>sample n ?value? ...</b>
<ul>Gets or sets sample number <b>n</b>. When setting samples one value
should be specified for each channel. A ? character can be used to specify
that a certain value should not be affected, i. e. "snd sample 10000 ?
999", would set the right channel of sample number 10000 of sound snd to
the value of 999 without influencing the left channel. Samples can be read
for all sound types but can only be set for in-memory sounds.</ul>
<a NAME="sstop"></a><i>soundName </i><b>stop</b>
<ul>Stops current play or record operation. If there is a queue of sounds
to play, each of them can stop playback using <b>stop</b>. Any callbacks
registered using the <b>-command</b> option of the <b>play</b> command
will not be executed.</ul>
<a NAME="swrite"></a><i>soundName </i><b>write </b><i>filename</i><b> ?-start
start? ?-end end?</b> <b>?-fileformat fileformat? ?-byteorder endianess?
?-progress procedure?</b>
<ul>Writes sound data to a file. A range of samples to save can be specified
using the <b>-start</b> and <b>-end</b> options. The file format is inferred
from the filename extension. Currently, the supported formats are WAV,
AU, SND, AIFF, SMP, CSL, and RAW. The <b>-fileformat</b> option overrides
the guess from file name extension. If you specify RAW file format the
sound will be saved to file without a header using the natural byte order
of the machine. This can be overridden using the option -<b>byteorder</b>.
See the <a href="#sread">read</a> command for a description on how to use
the <b>-progress</b> option.</ul>

<h3>

<hr WIDTH="100%"></h3>

<h3>
<a NAME="spectrogram"></a>NAME</h3>
spectrogram - Spectrogram canvas item
<h3>
SYNOPSIS</h3>
<i>pathName</i> <b>create</b> <b>spectrogram</b> x y ?options value option
value ...?
<h3>
OPTIONS</h3>

<dd>
<i>-</i><b>anchor</b><i> anchorPos</i></dd>

<dd>
<i>-</i><b>brightness</b><i> value</i></dd>

<dd>
<i>-</i><b>channel</b><i> channel</i></dd>

<dd>
<i>-</i><b>colormap</b><i> colorlist</i></dd>

<dd>
<i>-</i><b>contrast</b><i> value</i></dd>

<dd>
<i>-</i><b>end</b><i> sample</i></dd>

<dd>
-<b>fftlength</b><i> length</i></dd>

<dd>
<i>-</i><b>gridcolor</b><i> color</i></dd>

<dd>
<i>-</i><b>gridfspacing</b><i> value</i></dd>

<dd>
<i>-</i><b>gridtspacing</b><i> value</i></dd>

<dd>
-<b>height</b><i> size</i></dd>

<dd>
-<b>pixelspersecond</b><i> value</i></dd>

<dd>
-<b>preemphasisfactor</b><i> factor</i></dd>

<dd>
-<b>sound</b><i> name</i></dd>

<dd>
<i>-</i><b>start</b><i> sample</i></dd>

<dd>
-<b>tags </b><i>tagList</i></dd>

<dd>
<i>-</i><b>topfrequency</b><i> frequency</i></dd>

<dd>
-<b>width</b><i> size</i></dd>

<dd>
-<b>windowtype</b><i> type</i></dd>

<dd>
-<b>winlength</b><i> length</i></dd>

<h3>
DESCRIPTION</h3>
This command draws a spectrogram of a sound on a canvas. The options <i>-</i><b>anchor</b>,
and -<b>tags</b> work as for ordinary Tk canvas items. -<b>sound</b> specifies
which sound object to link to and -<b>height</b> the height of the spectrogram.
The option <b>-fftlength</b> specifies the number of FFT points (8, 16,
32, 64, 128, 256, 512, 1024, 2048, or 4096). The option <b>-windowtype</b>
is used to select windowing function, (valid values are Hamming, Hanning,
Bartlett, Blackman, or Rectangle). <b>-winlength</b> specifies the size
of the hamming window, which should be equal to or less than the number
of FFT points. -<b>preemphasisfactor</b> is used to specify the amount
of preemphasis applied to the signal prior to the FFT calculation. <b>-start</b>
and <b>-end</b> controls which part of the sound to display. <b>-pixelspersecond</b>
determines the scaling factor in the x-direction. The <b>-width</b> option
specifies the width of the spectrogram. If both <b>-width</b> and <b>-pixelspersecond</b>
are specified the spectrogram will be cut at one end depending on if a
<b>-start</b>
or <b>-end</b> option was also given. Use the <b>-channel</b> option to
select which channel to show for multichannel sounds. Use left, right,
both, all, -1 (all) or a channel number counting from 0 (left). The default
is to show all, i.e. to add all channels. <i>-</i><b>brightness</b> and
<i>-</i><b>contrast</b>
takes values beteween -100.0 and 100.0 with the default being 0.0. <i>-</i><b>topfrequency</b>
is the frequency value at the top of the spectrogram, default is the Nyquist
frequency. <i>-</i><b>gridtspacing</b> is the spacing between markers in
seconds (default 0 means no grid) and
<i>-</i><b>gridfspacing</b> is the
frequency spacing in Hz (default 0 means no grid). -<b>gridcolor</b> specifies
the color of the grid. A colormap for the spectrogram is given with the
<i>-</i><b>colormap</b>
option. It takes a list of colors as parameter and at least two must be
specified. The first color is used for the lowest intensity in the spectrogram.
An empty list gives the default 32-level grey scale. Currently, spectrograms
have a width limit of 32767 pixels.
<br>See also the code examples in the widget demonstration.
<h3>

<hr></h3>

<h3>
<a NAME="section"></a>NAME</h3>
section - Spectrum section canvas item
<h3>
SYNOPSIS</h3>
<i>pathName</i> <b>create</b> <b>section</b> x y ?options value option
value ...?
<h3>
OPTIONS</h3>

<dd>
<i>-</i><b>anchor</b><i> anchorPos</i></dd>

<dd>
<i>-</i><b>channel</b><i> channel</i></dd>

<dd>
<i>-</i><b>end</b><i> sample</i></dd>

<dd>
-<b>fftlength</b><i> length</i></dd>

<dd>
<i>-</i><b>fill</b><i> color</i></dd>

<dd>
<i>-</i><b>frame</b><i> boolean</i></dd>

<dd>
-<b>height</b><i> size</i></dd>

<dd>
<i>-</i><b>maxvalue</b><i> value</i></dd>

<dd>
<i>-</i><b>minvalue</b><i> value</i></dd>

<dd>
-<b>preemphasisfactor</b><i> factor</i></dd>

<dd>
<b>-skip</b><i> points</i></dd>

<dd>
-<b>sound</b><i> name</i></dd>

<dd>
<i>-</i><b>start</b><i> sample</i></dd>

<dd>
<i>-</i><b>stipple</b><i> value</i></dd>

<dd>
-<b>tags </b><i>tagList</i></dd>

<dd>
<i>-</i><b>topfrequency</b><i> frequency</i></dd>

<dd>
-<b>width</b><i> size</i></dd>

<dd>
-<b>windowtype</b><i> type</i></dd>

<dd>
-<b>winlength</b><i> length</i></dd>

<h3>
DESCRIPTION</h3>
This command draws an FFT log power spectrum section of a sound on a canvas.
The options <i>-</i><b>anchor</b>, -<b>fill</b>, -<b>stipple</b>, and -<b>tags</b>
work as for ordinary Tk canvas line items. -<b>sound</b> specifies which
sound object to link to and -<b>height</b> and -<b>width</b> the height/width
of the section.The option <b>-fftlength</b> specifies the number of FFT
points (8, 16, 32, 64, 128, 256, 512, 1024, 2048, or 4096). The option
<b>-windowtype</b>
is used to select windowing function, (valid values are Hamming, Hanning,
Bartlett, Blackman, or Rectangle). <b>-winlength</b> specifies the size
of the window, which should be equal to or less than the number of FFT
points. -<b>preemphasisfactor</b> is used to specify the amount of preemphasis
applied to the signal prior to the FFT calculation.
<b>-start</b> and <b>-end</b>
controls which part of the sound to display.
<i>-</i><b>topfrequency</b>
is the frequency value at the right end of the section. -<b>maxvalue</b>
and -<b>minvalue</b> specify the range (in dB) which will be shown (default
0.0 to -80.0). Use the <b>-channel</b> option to select which channel to
show for multichannel sounds. Use left, right, both, all, -1 (all) or a
channel number counting from 0 (left). The default is to show all, i.e.
to add all channels. <b>-frame</b> specifies whether a frame will be drawn
around the spectrum section.
<br>See also the code examples in the widget demonstration.
<p>
<hr>
<h3>
<a NAME="waveform"></a>NAME</h3>
waveform - Waveform canvas item
<h3>
SYNOPSIS</h3>
<i>pathName</i> <b>create</b> <b>waveform </b>x y ?option value option
value ...?
<h3>
OPTIONS</h3>

<dd>
<i>-</i><b>anchor</b><i> anchorPos</i></dd>

<dd>
<i>-</i><b>channel</b><i> channel</i></dd>

<dd>
-<b>end </b><i>sample</i></dd>

<dd>
-<b>fill </b><i>color</i></dd>

<dd>
<i>-</i><b>frame</b><i> boolean</i></dd>

<dd>
-<b>height</b><i> size</i></dd>

<dd>
<i>-</i><b>limit</b><i> value</i></dd>

<dd>
-<b>pixelspersecond</b><i> value</i></dd>

<dd>
<b>-progress</b> <i>procedure</i></dd>

<dd>
<i>-</i><b>shapefile</b><i> filename</i></dd>

<dd>
-<b>sound</b><i> name</i></dd>

<dd>
-<b>start </b><i>sample</i></dd>

<dd>
-<b>stipple </b><i>bitmap</i></dd>

<dd>
<i>-</i><b>subsample</b><i> value</i></dd>

<dd>
-<b>tags </b><i>tagList</i></dd>

<dd>
-<b>width</b><i> size</i></dd>

<dd>
-<b>zerolevel</b><i> boolean</i></dd>

<h3>
DESCRIPTION</h3>
This command draws the waveform of a sound on a canvas. The options <i>-</i><b>anchor</b>,
-<b>fill</b>, -<b>stipple</b>, and -<b>tags</b> work as for ordinary Tk
canvas line items. -<b>sound</b> specifies which sound object to link to
and -<b>height</b> the height of the waveform. The options <b>-start</b>
and <b>-end</b> controls which part of the sound to display. -<b>pixelspersecond</b>
determines the scaling factor in the x-direction. The <b>-width</b> option
specifies the width of the waveform. If both <b>-width</b> and <b>-pixelspersecond</b>
are specified the waveform will be cut at one end depending on if a <b>-start</b>
or <b>-end</b> option was also given. Use the <b>-channel</b> option to
select which channel to show for multichannel sounds. Use left, right,
both, all, -1 (all) or a channel number counting from 0. The default is
to show all, i.e. to add all channels. Use <b>-limit</b> to specify the
maximum shown value for the sound amplitude. <b>-zerolevel</b> specifies
whether the zero level will be displayed and <b>-frame</b> whether a frame
will be drawn around the waveform. The <i>-</i><b>subsample</b> option
is useful for large sounds to specify how precisely they should be analyzed
for shape calculation. The default value 1 uses every sample in the sound
to draw the waveform envelope, which can be slow for large sounds. A value
of 10 uses every 10th. Care should be used when specifying this because
a large value could lead to an incorrect envelope shape. The option -<b>shapefile</b>
is used to specify a file for storing/retrieving precomputed waveform shape
information. If the file doesn't exist it is created. If it exists it is
accessed instead of the sound data itself, thus speeding up on-screen display.
There exists two convenience routines, snack::deleteInvalidShapeFile and
snack::makeShapeFileDeleteable, which can be used to enclose a <b>create
waveform</b> statement when using the shape file functionality. These will
make sure that shape files are handled properly, see the demo cool.tcl,
for an example of this. See the <a href="#sread">read</a> command for a
description on how to use the <b>-progress</b> option.
<br>See also code examples in the widget demonstration.
<p>
<hr>
<p>The command <b>package require snack</b> gives you access to all commands
described above.
<br>There is also a package called <b>sound</b> which gives you the <b>snack::audio,
snack::filter, snack::mixer, </b>and <b>snack::sound </b>commands. This is useful on some systems if you want to use the tclsh interpreter.
<p>
<hr WIDTH="100%">
<br><a href="http://www.speech.kth.se/snack/index.html">Snack home</a>
</body>
</html>
