# Commands covered: sound pitch
#

package require -exact snack 2.1

if {[lsearch [namespace children] ::tcltest] == -1} {
    package require tcltest
    namespace import ::tcltest::*
}

test pitch-1.1 {pitch command} {
  set s [snack::sound snd -load ex1.wav]
  set res [$s pitch]
  $s destroy
  set res
} {0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 163.0 163.0 161.0 158.0 153.0 148.0 141.0 133.0 126.0 119.0 111.0 109.0 108.0 106.0 105.0 105.0 107.0 109.0 111.0 115.0 112.0 121.0 139.0 139.0 141.0 145.0 148.0 149.0 148.0 145.0 140.0 132.0 125.0 118.0 111.0 106.0 112.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0}

test pitch-1.2 {pitch command} {
  set s [snack::sound snd -load ex1.wav]
  set res [$s pitch -start 4800 -end 4960]
  $s destroy
  set res
} {141.0 133.0}

test pitch-2.1 {pitch command, with missing argument for -start option} {
  set s [snack::sound snd -load ex1.wav]
  catch {$s pitch -start} msg
  $s destroy
  set msg
} {No argument given for -start option}

test pitch-3.1 {pitch command, -progress option} {
  set res ""
  proc prog {msg frac} {
    lappend ::res [expr 0.1 * int(10*$frac)]
  }
  set s [snack::sound snd -load ex1.wav]
  $s pitch -progress prog
  $s destroy
  set res
} {0.0 0.2 0.4 0.6 0.8 1.0}

# cleanup
::tcltest::cleanupTests
return
